BEGIN;

--VUE_1 : nombre de cinéma indépendants en fonction du type de RSA dans une zone donnée pour créer une dataviz DOT MAP--
--NOTE : croise les tables cinemas, aire_geographique --

CREATE VIEW vw_dotmap_cinema_rsa AS
(
SELECT 
--table aire_geographique ag, attribut type_rsa--
    ag.type_rsa,
--compte le nombre de cinema, avec alias nb_cinema--
    COUNT(c.id_cinema) AS nb_cinemas
--partant de la table cinema, alias c--
FROM cinema c
JOIN aire_geographique ag 
    ON c.id_aire_geographique = ag.id_aire_geographique

--rassemble les résultats par aire géographique à propos du type de rsa--
GROUP BY ag.type_rsa
);

---

--VUE_2 : évolution de la fréquentation des cinémas indépendants entre 2021 et 2024 pour créer une dataviz LINE CHART--
--NOTE : croise les tables cinemas, frequentation--
CREATE VIEW vw_evolution_frequentation_2021_2024 AS

-- Année 2021--
-- On sélectionne 2021 comme valeur fixe pour la colonne "annee"--
-- et on additionne toutes les entrées 2021--
(
SELECT 
    2021 AS annee,                     -- Colonne année--
    SUM(entree2021) AS total_entrees   -- Total des entrées pour 2021--
FROM frequentation

UNION ALL

-- Année 2022--
SELECT 
    2022 AS annee,                     
    SUM(entree2022) AS total_entrees
FROM frequentation

UNION ALL

-- Année 2023--
SELECT 
    2023 AS annee,                     
    SUM(entree2023) AS total_entrees
FROM frequentation

UNION ALL

-- Année 2024--
SELECT 
    2024 AS annee,                     
    SUM(entree2024) AS total_entrees
FROM frequentation
);

---

--VUE_3 : propose de voir l'origine des films VO/VF pour aboutir à une dataviz en DIAGRAM RADAR--

COMMIT;
