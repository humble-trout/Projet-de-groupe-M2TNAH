BEGIN;

--VUE_1 : nombre de cinéma indépendants en fonction du type de RSA dans une zone donnée (implique de connaitre aussi la taille du cinéma) pour créer une dataviz DOT MAP--
--NOTE : croise les tables cinemas, aire_geographique --
--Type d'agrégation: round ?  --
CREATE VIEW vw_dotmap_cinemas_rsa AS
(
SELECT DISTINCT
--caractéristiques du cinéma--
    cinema.nom_cinema,
    cinema.code_insee,
    cinema.lattitude,
    cinema.longitude,
    cinema.fauteuils,
    cinema.ecrans,

--caractéristiques de l'aire géographique--
    aire_geographique.nb_pers,
    aire_geographique.nb_foyer,
    aire_geographique.commune,

--partant de la table cinéma, qui est notre table centrale--
    FROM cinema 
   
--inserer round ??--
    ) AS 
FROM cinema
INNER JOIN rsa ??
    ON 
WHERE cinema??
);

---

--VUE_2 : évolution de la fréquentation des cinémas indépendants entre 2021 et 2024 pour créer une dataviz LINE CHART--
--NOTE : croise les tables cinemas, frequentation--
--Type d'agrégation: sum ?  --
CREATE VIEW vw_evolution_frequentation AS
(
SELECT
    annee,
    SUM(entrees) AS total_entrees
FROM (
    SELECT 2021 AS annee, entree_2021 AS entrees
    FROM cinema
    WHERE ??
    UNION ALL

    SELECT 2022 AS annee, entree_2022
    FROM cinemas
    WHERE ??

    UNION ALL

    SELECT 2023 AS annee, entree_2023
    FROM cinemas
    WHERE ??

    UNION ALL

    SELECT 2024 AS annee, entree_2024
    FROM cinemas
    WHERE ??
) 
GROUP BY annee
ORDER BY annee
);




--VUE_3 : propose de voir l'origine des films VO/VF pour aboutir à une dataviz en DIAGRAM RADAR--

COMMIT;
