BEGIN;

--VUE_1 : sélectionne les cinémas mentionnés dans la programmation--
--NOTE : croise les tables programmation-cinémas, géographie-du-cinéma-départements, établissement-cinématographiques en LEFT JOIN--
--Type d'agrégation: à remplir --
create view vw_cinemas_programmes as 
SELECT
    programmation_cinema.id_programmation,
    programmation_cinema.id_cinema,
    cinema.nom_cinema,
    aire_geographique.commune,
    aire_geographique.nom_departement,
    aire_geographique.code_departement
FROM programmation_cinema
LEFT JOIN cinema
    ON programmation_cinema.id_cinema = cinema.id_cinema
LEFT JOIN aire_geographique
    ON cinema.id_aire_geographique = aire_geographique.id_aire_geographique;



--VUE_2 : sélectionne toutes les données pour construire une carte intéractive--
--NOTE : croise les tables programmation-cinémas, géographie-du-cinéma-départements, établissement-cinématographiques en INNER JOIN--
--Type d'agrégation: 
--copie cours à finir --
create view vw_coordonnees_geographiques as
(
select b."label" as genre, round(avg(devis))
from  a
inner join genre b on a.id_genre = b.id_genre
group by b."label"
);

--VUE_3 : compte le nombre de cinéma en fonction de données socio-économique provenant d'un jeu de données sur le RSA--
--NOTE : croise les tables Croiser géographie-du-cinéma-départements, Données-cartographie-2024, établissement-cinématographiques, repartition-des-allocataires-selon-le-type-de-rsa-communal en LEFT JOIN--
--Type d'agrégation : à remplir--
--je galère un peu sur celle-ci--
COMMIT;
