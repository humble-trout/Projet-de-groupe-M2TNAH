BEGIN;

--VUE_1 : nombre de cinéma indépendants en fonction du type de RSA dans une zone donnée pour créer une dataviz DOT MAP--
--NOTE : croise les tables cinemas, aire_geographique --

CREATE VIEW vw_dotmap_cinema_rsa AS
(
SELECT 
--table aire_geographique ag, attribut type_rsa--
    ag.type_rsa,
--compte le nombre de cinema, avec alias nb_cinema--
    COUNT(c.id_cinema) AS nb_cinemas
--partant de la table cinema, alias c--
FROM cinema c
JOIN aire_geographique ag 
    ON c.id_aire_geographique = ag.id_aire_geographique

--rassemble les résultats par aire géographique à propos du type de rsa--
GROUP BY ag.type_rsa
);

---

--VUE_2 : évolution de la fréquentation des cinémas indépendants entre 2021 et 2024 pour créer une dataviz LINE CHART--
--NOTE : croise les tables cinemas, frequentation--
--Type d'agrégation: sum ?  --
CREATE VIEW vw_evolution_frequentation AS
(
SELECT
    annee,
    SUM(entrees) AS total_entrees
FROM (
    SELECT 2021 AS annee, entree_2021 AS entrees
    FROM cinema
    WHERE ??
    UNION ALL

    SELECT 2022 AS annee, entree_2022
    FROM cinemas
    WHERE ??

    UNION ALL

    SELECT 2023 AS annee, entree_2023
    FROM cinemas
    WHERE ??

    UNION ALL

    SELECT 2024 AS annee, entree_2024
    FROM cinemas
    WHERE ??
) 
GROUP BY annee
ORDER BY annee
);




--VUE_3 : propose de voir l'origine des films VO/VF pour aboutir à une dataviz en DIAGRAM RADAR--

COMMIT;
