
-- Creation de la table film 
create table film
--notes: besoin de rajouter des accents car ils ne sont pas accept√©s dans les noms des attributs. table jointe
(
	id_film INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	titre VARCHAR NOT NULL,
	genre VARCHAR,
	duree INTEGER,
	realisateur VARCHAR,
	date_sortie VARCHAR,
	note INTEGER
);

-- Remplissage de la table film 
INSERT INTO film 
(titre, genre, duree, realisateur, date_sortie, note)
SELECT DISTINCT 
	titre,
	genre,
	duree,
	realisateur,
	annee_sortie AS date_sortie,
	note_sur_100
FROM TMP_wiki1 
where titre is not null

UNION

SELECT DISTINCT 
	titre,
	genre,
	duree,
	realisateur,
	annee_sortie AS date_sortie,
	note_sur_100
FROM TMP_wiki2
where titre is not null;




insert into aire_geographique
(commune, region, code_insee, code_departement, type_rsa,
nb_foyers, nb_personnes)
select distinct 
	a.commune, 
	a.region_cnc as region,
	a.code_insee, 
	a.departement as code_departement, 
	b.type_rsa,
	b.nbr_foyer_rsa as nb_foyers, 
	b.nbr_pers_rsa as nb_personnes
from tmp_cnc a
left join tmp_rsa b on a.commune = b.commune; 
